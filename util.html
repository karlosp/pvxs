
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Misc &#8212; PVXS 0.0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="example.html" />
    <link rel="prev" title="Data Source API" href="source.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="misc">
<h1>Misc<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p>PVXS internally logs warning/status messages using errlog.h from EPICS Base.
User applications may control which messages are printed, and may add output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;pvxs/log.h&gt;</span>
<span class="n">namespace</span> <span class="n">pvxs</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>Control of log message output is available through named loggers.
All internal logger names begin with the prefix “pvxs.”.</p>
<p>In addition to a name, each logger has an associated integer logging level.
A message will be logged if the level of the message is less than or
equal to the level of the associated logger.</p>
<p>To enable all logging at full detail.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">PVXS_LOG</span><span class="o">=</span><span class="s2">&quot;*=DEBUG&quot;</span>
</pre></div>
</div>
<dl class="type">
<dt id="_CPPv4N4pvxs5LevelE">
<span id="_CPPv3N4pvxs5LevelE"></span><span id="_CPPv2N4pvxs5LevelE"></span><span id="pvxs::Level"></span><span class="target" id="namespacepvxs_1a2002ba833e9865a042be6648dc9f2a74"></span><em class="property">enum </em><code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">Level</code><a class="headerlink" href="#_CPPv4N4pvxs5LevelE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Importance of message. </p>
<p><em>Values:</em></p>
<dl class="enumerator">
<dt id="_CPPv4N4pvxs5DebugE">
<span id="_CPPv3N4pvxs5DebugE"></span><span id="_CPPv2N4pvxs5DebugE"></span><span class="target" id="namespacepvxs_1a2002ba833e9865a042be6648dc9f2a74aa603905470e2a5b8c13e96b579ef0dba"></span><code class="descname">Debug</code> = 50<a class="headerlink" href="#_CPPv4N4pvxs5DebugE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv4N4pvxs4InfoE">
<span id="_CPPv3N4pvxs4InfoE"></span><span id="_CPPv2N4pvxs4InfoE"></span><span class="target" id="namespacepvxs_1a2002ba833e9865a042be6648dc9f2a74a4059b0251f66a18cb56f544728796875"></span><code class="descname">Info</code> = 40<a class="headerlink" href="#_CPPv4N4pvxs4InfoE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv4N4pvxs4WarnE">
<span id="_CPPv3N4pvxs4WarnE"></span><span id="_CPPv2N4pvxs4WarnE"></span><span class="target" id="namespacepvxs_1a2002ba833e9865a042be6648dc9f2a74a56525ae64d370c0b448ac0d60710ef17"></span><code class="descname">Warn</code> = 30<a class="headerlink" href="#_CPPv4N4pvxs4WarnE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv4N4pvxs3ErrE">
<span id="_CPPv3N4pvxs3ErrE"></span><span id="_CPPv2N4pvxs3ErrE"></span><span class="target" id="namespacepvxs_1a2002ba833e9865a042be6648dc9f2a74ab47f6a6092c5d7e4bffec12dff309c3b"></span><code class="descname">Err</code> = 20<a class="headerlink" href="#_CPPv4N4pvxs3ErrE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="enumerator">
<dt id="_CPPv4N4pvxs4CritE">
<span id="_CPPv3N4pvxs4CritE"></span><span id="_CPPv2N4pvxs4CritE"></span><span class="target" id="namespacepvxs_1a2002ba833e9865a042be6648dc9f2a74a304c415e7242947be288863d75041ed9"></span><code class="descname">Crit</code> = 10<a class="headerlink" href="#_CPPv4N4pvxs4CritE" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

<div class="section" id="controlling-logging">
<h3>Controlling Logging<a class="headerlink" href="#controlling-logging" title="Permalink to this headline">¶</a></h3>
<p>By default, all loggers have level Err.
It is recommended that user applications prefer configuration
through the environment variable <strong>$PVXS_LOG</strong> by calling <a class="reference internal" href="#_CPPv4N4pvxs17logger_config_envEv" title="pvxs::logger_config_env"><code class="xref any cpp cpp-function docutils literal notranslate"><span class="pre">pvxs::logger_config_env()</span></code></a>.</p>
<dl class="function">
<dt id="_CPPv4N4pvxs17logger_config_envEv">
<span id="_CPPv3N4pvxs17logger_config_envEv"></span><span id="_CPPv2N4pvxs17logger_config_envEv"></span><span id="pvxs::logger_config_env"></span><span class="target" id="namespacepvxs_1af2bc724538957a4ec40b10714bece689"></span>void <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">logger_config_env</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs17logger_config_envEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Configure logging from environment variable <strong>$PVXS_LOG</strong></p>
<p><a class="reference internal" href="value.html#classpvxs_1_1Value"><span class="std std-ref">Value</span></a> of the form “key=VAL,…”</p>
<p>Keys may be literal logger names, or may include ‘*’ wildcards to match multiple loggers. eg. “pvxs.*=DEBUG” will enable all internal log messages.</p>
<p>VAL may be one of “CRIT”, “ERR”, “WARN”, “INFO”, or “DEBUG” </p>
</dd></dl>

<p>If this is undesireable, logger levels may be (reset) manually.</p>
<dl class="function">
<dt id="_CPPv4N4pvxs16logger_level_setEPKc5Level">
<span id="_CPPv3N4pvxs16logger_level_setEPKc5Level"></span><span id="_CPPv2N4pvxs16logger_level_setEPKc5Level"></span><span id="pvxs::logger_level_set__cCP.Level"></span><span class="target" id="namespacepvxs_1a0e1536315b9291ae8b185e78ad4010f7"></span>void <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">logger_level_set</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>name</em>, <a class="reference internal" href="#_CPPv4N4pvxs5LevelE" title="pvxs::Level">Level</a> <em>lvl</em><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs18logger_level_clearEv">
<span id="_CPPv3N4pvxs18logger_level_clearEv"></span><span id="_CPPv2N4pvxs18logger_level_clearEv"></span><span id="pvxs::logger_level_clear"></span><span class="target" id="namespacepvxs_1a70755c4835ab2262b3c59a2364836702"></span>void <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">logger_level_clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs18logger_level_clearEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Remove any previously logger configurations. Does <em>not</em> change any <a class="reference internal" href="#structpvxs_1_1logger_1a3f166cbaec8e1f4ec940b14634635a91"><span class="std std-ref">logger::lvl</span></a> Use prior to re-applying new configuration. </p>
</dd></dl>

</div>
<div class="section" id="logging-from-user-applications">
<h3>Logging from User applications<a class="headerlink" href="#logging-from-user-applications" title="Permalink to this headline">¶</a></h3>
<p>To emit log messages from user code, a new logger should be defined with <a class="reference internal" href="#c.DEFINE_LOGGER" title="DEFINE_LOGGER"><code class="xref any c c-macro docutils literal notranslate"><span class="pre">DEFINE_LOGGER</span></code></a>
which will be usable within the current translation unit.
It is allowable for multiple loggers to have the same name.</p>
<p>Logger names beginning with “pvxs.*” is reserved for internal usage,
and must not be present in user code.</p>
<dl class="macro">
<dt id="c.DEFINE_LOGGER">
<span class="target" id="log_8h_1ae69702365be442df488ab0b567c2dbd2"></span><code class="descname">DEFINE_LOGGER</code><span class="sig-paren">(</span>VAR, NAME<span class="sig-paren">)</span><a class="headerlink" href="#c.DEFINE_LOGGER" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a new logger global. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">VAR</span></code>: The (static) variable name passed to log_printf() and friends. </li>
<li><code class="docutils literal notranslate"><span class="pre">NAME</span></code>: A name string in “A.B.C” form. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.log_crit_printf">
<span class="target" id="log_8h_1af4fc82d1246e68f21398d5238505e8fb"></span><code class="descname">log_crit_printf</code><span class="sig-paren">(</span>LOGGER, FMT, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.log_crit_printf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.log_err_printf">
<span class="target" id="log_8h_1aac46c74e2596860d9be0c8d6a1baed8f"></span><code class="descname">log_err_printf</code><span class="sig-paren">(</span>LOGGER, FMT, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.log_err_printf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.log_warn_printf">
<span class="target" id="log_8h_1a0de6e25341c1c80c5c2f0fd2628db7f2"></span><code class="descname">log_warn_printf</code><span class="sig-paren">(</span>LOGGER, FMT, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.log_warn_printf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.log_info_printf">
<span class="target" id="log_8h_1ac700c9906a5d77b5ac8b9ff8e5382601"></span><code class="descname">log_info_printf</code><span class="sig-paren">(</span>LOGGER, FMT, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.log_info_printf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.log_debug_printf">
<span class="target" id="log_8h_1a32d2594ab6339c0b8f2da0e48457260d"></span><code class="descname">log_debug_printf</code><span class="sig-paren">(</span>LOGGER, FMT, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.log_debug_printf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.log_printf">
<span class="target" id="log_8h_1adc252d60fc7f77c8b2321d3cf6d7b8f2"></span><code class="descname">log_printf</code><span class="sig-paren">(</span>LOGGER, LVL, FMT, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.log_printf" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to log a message at the defined level.</p>
<p>Due to portability issues with MSVC, log formats must have at least one argument.</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DEFINE_LOGGER</span><span class="p">(</span><span class="n">blah</span><span class="p">,</span> <span class="s2">&quot;myapp.blah&quot;</span><span class="p">);</span>
<span class="n">void</span> <span class="n">blahfn</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">log_info_printf</span><span class="p">(</span><span class="n">blah</span><span class="p">,</span> <span class="s2">&quot;blah happened with </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
 </p>
</dd></dl>

<dl class="class">
<dt id="_CPPv4N4pvxs6loggerE">
<span id="_CPPv3N4pvxs6loggerE"></span><span id="_CPPv2N4pvxs6loggerE"></span><span id="pvxs::logger"></span><span class="target" id="structpvxs_1_1logger"></span><em class="property">struct </em><code class="descname">logger</code><a class="headerlink" href="#_CPPv4N4pvxs6loggerE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A logger. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv4N4pvxs6logger4testE5Level">
<span id="_CPPv3N4pvxs6logger4testE5Level"></span><span id="_CPPv2N4pvxs6logger4testE5Level"></span><span id="pvxs::logger::test__Level"></span><span class="target" id="structpvxs_1_1logger_1ae395407864632542caed8cb84c425141"></span>bool <code class="descname">test</code><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4pvxs5LevelE" title="pvxs::Level">Level</a> <em>lvl</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs6logger4testE5Level" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>true if the logger currently allows a message at level LVL. </dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="member">
<dt id="_CPPv4N4pvxs6logger4nameE">
<span id="_CPPv3N4pvxs6logger4nameE"></span><span id="_CPPv2N4pvxs6logger4nameE"></span><span id="pvxs::logger::name__cCPC"></span><span class="target" id="structpvxs_1_1logger_1a169a4e4534d2134c59012e078369bb78"></span><em class="property">const</em> char *<em class="property">const</em> <code class="descname">name</code><a class="headerlink" href="#_CPPv4N4pvxs6logger4nameE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>global name of this logger. Need not be unique </p>
</dd></dl>

<dl class="member">
<dt id="_CPPv4N4pvxs6logger3lvlE">
<span id="_CPPv3N4pvxs6logger3lvlE"></span><span id="_CPPv2N4pvxs6logger3lvlE"></span><span id="pvxs::logger::lvl__std::atomic:Level:"></span><span class="target" id="structpvxs_1_1logger_1a3f166cbaec8e1f4ec940b14634635a91"></span>std::atomic&lt;<a class="reference internal" href="#_CPPv4N4pvxs5LevelE" title="pvxs::Level">Level</a>&gt; <code class="descname">lvl</code><a class="headerlink" href="#_CPPv4N4pvxs6logger3lvlE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Current logging level. See logger_level_set(). </p>
</dd></dl>

</div>
</dd></dl>

</div>
</div>
<div class="section" id="identification">
<h2>Identification<a class="headerlink" href="#identification" title="Permalink to this headline">¶</a></h2>
<p>Compile time access to PVXS library version information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;pvxs/util.h&gt;</span>
<span class="n">namespace</span> <span class="n">pvxs</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="macro">
<dt id="c.PVXS_VERSION">
<span class="target" id="version_8h_1a4aa197390233f8c5822343d510a8f907"></span><code class="descname">PVXS_VERSION</code><a class="headerlink" href="#c.PVXS_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>Current library version. </p>
</dd></dl>

<dl class="macro">
<dt id="c.VERSION_INT">
<span class="target" id="version_8h_1aec3b51ad3030e7a0894015698908ee00"></span><code class="descname">VERSION_INT</code><span class="sig-paren">(</span>V, R, M, P<span class="sig-paren">)</span><a class="headerlink" href="#c.VERSION_INT" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct version number constant. </p>
</dd></dl>

<p>eg. to conditionally compile based on library version.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#if PVXS_VERSION &lt; VERSION_INT(1,2,3,4)</span>
<span class="o">//</span> <span class="n">enable</span> <span class="n">some</span> <span class="n">compatibility</span> <span class="n">code</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<dl class="function">
<dt id="_CPPv4N4pvxs11version_intEv">
<span id="_CPPv3N4pvxs11version_intEv"></span><span id="_CPPv2N4pvxs11version_intEv"></span><span id="pvxs::version_int"></span><span class="target" id="namespacepvxs_1af786698c8b10afab7bb2a951392d1037"></span>unsigned long <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">version_int</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs11version_intEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>PVXS_VERSION captured at library compile time </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs11version_strEv">
<span id="_CPPv3N4pvxs11version_strEv"></span><span id="_CPPv2N4pvxs11version_strEv"></span><span id="pvxs::version_str"></span><span class="target" id="namespacepvxs_1aa2025ba743dc2e7eead50fd05a068ae2"></span><em class="property">const</em> char *<code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">version_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs11version_strEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Library version as a string. eg. “PVXS 1.2.3”. </p>
</dd></dl>

</div>
<div class="section" id="unit-test-helpers">
<h2>Unit-test helpers<a class="headerlink" href="#unit-test-helpers" title="Permalink to this headline">¶</a></h2>
<p>Extensions to epicsUnitTest.h</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;pvxs/unittest.h&gt;</span>
<span class="n">namespace</span> <span class="n">pvxs</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="macro">
<dt id="c.testTrue">
<span class="target" id="unittest_8h_1aa9120f13b403b4e1830b7b7efef78714"></span><code class="descname">testTrue</code><span class="sig-paren">(</span>EXPR<span class="sig-paren">)</span><a class="headerlink" href="#c.testTrue" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro which assert that an expression evaluate to ‘true’. Evaluates to a <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">pvxs::testCase</span></a> </p>
</dd></dl>

<dl class="macro">
<dt id="c.testFalse">
<span class="target" id="unittest_8h_1ab7b6a25f28131950ce24e44e237f298f"></span><code class="descname">testFalse</code><span class="sig-paren">(</span>EXPR<span class="sig-paren">)</span><a class="headerlink" href="#c.testFalse" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro which assert that an expression evaluate to ‘true’. Evaluates to a <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">pvxs::testCase</span></a> </p>
</dd></dl>

<dl class="macro">
<dt id="c.testEq">
<span class="target" id="unittest_8h_1a65eb08838bd7c40e6e14599695b2fecf"></span><code class="descname">testEq</code><span class="sig-paren">(</span>LHS, RHS<span class="sig-paren">)</span><a class="headerlink" href="#c.testEq" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro which asserts equality between LHS and RHS. Evaluates to a <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">pvxs::testCase</span></a> Roughly equivalent to<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testOk</span><span class="p">((</span><span class="n">LHS</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="n">RHS</span><span class="p">),</span> <span class="s2">&quot;...&quot;</span><span class="p">);</span> 
</pre></div>
</div>
 </p>
</dd></dl>

<dl class="macro">
<dt id="c.testNotEq">
<span class="target" id="unittest_8h_1adf653ed57697e8278999f422a7b0a383"></span><code class="descname">testNotEq</code><span class="sig-paren">(</span>LHS, RHS<span class="sig-paren">)</span><a class="headerlink" href="#c.testNotEq" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro which asserts in-equality between LHS and RHS. Evaluates to a <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">pvxs::testCase</span></a> Roughly equivalent to<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testOk</span><span class="p">((</span><span class="n">LHS</span><span class="p">)</span><span class="o">!=</span><span class="p">(</span><span class="n">RHS</span><span class="p">),</span> <span class="s2">&quot;...&quot;</span><span class="p">);</span> 
</pre></div>
</div>
 </p>
</dd></dl>

<dl class="macro">
<dt id="c.testShow">
<span class="target" id="unittest_8h_1a8cb86f8c976018b5171e6935bbdcb00e"></span><code class="descname">testShow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.testShow" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro which prints diagnostic (non-test) lines. Evaluates to a <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">pvxs::testCase</span></a> Roughly equivalent to<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testDiag</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">);</span> 
</pre></div>
</div>
 </p>
</dd></dl>

<p>The testEq() macro and friends expand to a function which returns a <a class="reference internal" href="#_CPPv4N4pvxs8testCaseE" title="pvxs::testCase"><code class="xref any cpp cpp-class docutils literal notranslate"><span class="pre">pvxs::testCase</span></code></a> instance
which may be used as a <code class="xref any docutils literal notranslate"><span class="pre">std::ostream</span></code> to append text describing a test. eg.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testEq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="s2">&quot;We really hope this is true.&quot;</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">testNotEq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="s2">&quot;shouldn&#39;t be true&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">further</span> <span class="n">conditional</span> <span class="n">tests</span> <span class="k">if</span> <span class="mi">1</span><span class="o">!=</span><span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="function">
<dt id="_CPPv4N4pvxs10testThrowsE2FN">
<span id="_CPPv3N4pvxs10testThrowsE2FN"></span><span id="_CPPv2N4pvxs10testThrowsE2FN"></span><span id="pvxs::testThrows__FN"></span><em class="property">template </em>&lt;<em class="property">class</em> Exception, <em class="property">typename</em> FN&gt;<br /><span class="target" id="namespacepvxs_1a92bbce4ead844d9dd1b5debb00447bb6"></span><a class="reference internal" href="#_CPPv4N4pvxs8testCaseE" title="pvxs::testCase">testCase</a> <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">testThrows</code><span class="sig-paren">(</span>FN <em>fn</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs10testThrowsE2FN" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Assert that an exception is thrown.</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testThrows</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span><span class="o">&gt;</span><span class="p">([]()</span> <span class="p">{</span>
     <span class="n">testShow</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s2">&quot;Now you see me&quot;</span><span class="p">;</span>
     <span class="n">throw</span> <span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s2">&quot;I happened&quot;</span><span class="p">);</span>
     <span class="n">testShow</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s2">&quot;Now you don&#39;t&quot;</span><span class="p">;</span>
<span class="p">})</span><span class="o">&lt;&lt;</span><span class="s2">&quot;some message&quot;</span><span class="p">;</span>
</pre></div>
</div>
 <dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>A <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">testCase</span></a> which passes if an Exception instance was caught, and false otherwise (wrong type, or no exception).</dd>
<dt><strong>Template Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">Exception</span></code>: The exception type which should be thrown </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">fn</span></code>: A callable</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="class">
<dt id="_CPPv4N4pvxs8testCaseE">
<span id="_CPPv3N4pvxs8testCaseE"></span><span id="_CPPv2N4pvxs8testCaseE"></span><span id="pvxs::testCase"></span><span class="target" id="classpvxs_1_1testCase"></span><em class="property">class </em><code class="descname">testCase</code><a class="headerlink" href="#_CPPv4N4pvxs8testCaseE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A single test case (or diagnostic line).</p>
<p>Acts as an output string to accumulate test comment. Multi-line output results in one test line, and subsequent diagnostic lines.</p>
<p>Test line is printed when an active (non-moved) <a class="reference internal" href="#classpvxs_1_1testCase"><span class="std std-ref">testCase</span></a> is destroyed. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv4N4pvxs8testCase8testCaseEv">
<span id="_CPPv3N4pvxs8testCase8testCaseEv"></span><span id="_CPPv2N4pvxs8testCase8testCaseEv"></span><span id="pvxs::testCase::testCase"></span><span class="target" id="classpvxs_1_1testCase_1a207549f1459600c5e5e96a3b40d335b4"></span><code class="descname">testCase</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs8testCase8testCaseEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>new diag message </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs8testCase8testCaseEb">
<span id="_CPPv3N4pvxs8testCase8testCaseEb"></span><span id="_CPPv2N4pvxs8testCase8testCaseEb"></span><span id="pvxs::testCase::testCase__b"></span><span class="target" id="classpvxs_1_1testCase_1a903e0890acdd01aa5530607d09707905"></span><code class="descname">testCase</code><span class="sig-paren">(</span>bool <em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs8testCase8testCaseEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>new test case </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4NK4pvxs8testCasecvbEv">
<span id="_CPPv3NK4pvxs8testCasecvbEv"></span><span id="_CPPv2NK4pvxs8testCasecvbEv"></span><span id="pvxs::testCase::castto-b-operatorC"></span><span class="target" id="classpvxs_1_1testCase_1a5939022b3324c465c7e358b09482b158"></span><code class="descname">operator bool</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4pvxs8testCasecvbEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>true when passing </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs8testCase7setPassEb">
<span id="_CPPv3N4pvxs8testCase7setPassEb"></span><span id="_CPPv2N4pvxs8testCase7setPassEb"></span><span id="pvxs::testCase::setPass__b"></span><span class="target" id="classpvxs_1_1testCase_1a4cc9a9b96e352aada09da3992a72ff97"></span><a class="reference internal" href="#_CPPv4N4pvxs8testCaseE" title="pvxs::testCase">testCase</a> &amp;<code class="descname">setPass</code><span class="sig-paren">(</span>bool <em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs8testCase7setPassEb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Override current pass/fail result. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs8testCaselsERK1T">
<span id="_CPPv3N4pvxs8testCaselsERK1T"></span><span id="_CPPv2N4pvxs8testCaselsERK1T"></span><span id="pvxs::testCase::lshift-operator__TCR"></span><em class="property">template </em>&lt;<em class="property">typename</em> T&gt;<br /><span class="target" id="classpvxs_1_1testCase_1a90afc3773f9db9d45b6297579d65044f"></span><a class="reference internal" href="#_CPPv4N4pvxs8testCaseE" title="pvxs::testCase">testCase</a> &amp;<code class="descname">operator&lt;&lt;</code><span class="sig-paren">(</span><em class="property">const</em> T &amp;<em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs8testCaselsERK1T" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Append to message. </p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h2>
<p>Misc. utility code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;pvxs/util.h&gt;</span>
<span class="n">namespace</span> <span class="n">pvxs</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<dl class="function">
<dt id="_CPPv4N4pvxs6escapeERKNSt6stringE">
<span id="_CPPv3N4pvxs6escapeERKNSt6stringE"></span><span id="_CPPv2N4pvxs6escapeERKNSt6stringE"></span><span id="pvxs::escape__ssCR"></span><span class="target" id="namespacepvxs_1a79135087f4bbe47599d5a4528b23b81f"></span>detail::Escaper <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">escape</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>s</em><span class="sig-paren">)</span><br /></dt>
<dd><p>Print string to output stream with non-printable charactors escaped.</p>
<p>Outputs (almost) C-style escapes. Prefers short escapes for newline, tab, quote, etc (“\n”). Falls back to hex escape (eg. “\xab”).</p>
<p>Unlike C, hex escapes are always 2 chars. eg. the output “\xabcase” would need to be manually changed to “\xab”“case” to be used as C source.</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">::</span><span class="n">string</span> <span class="n">blah</span><span class="p">(</span><span class="s2">&quot;this </span><span class="se">\&quot;</span><span class="s2">is a test</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pvxs</span><span class="p">::</span><span class="n">escape</span><span class="p">(</span><span class="n">blah</span><span class="p">);</span>
</pre></div>
</div>
 </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs6escapeEPKc">
<span id="_CPPv3N4pvxs6escapeEPKc"></span><span id="_CPPv2N4pvxs6escapeEPKc"></span><span id="pvxs::escape__cCP"></span><span class="target" id="namespacepvxs_1a7b4c21d582220f7463be2544ccf34908"></span>detail::Escaper <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">escape</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>s</em><span class="sig-paren">)</span><br /></dt>
<dd><p>Print nil terminated char array to output stream with non-printable charactors escaped. <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pvxs</span><span class="p">::</span><span class="n">escape</span><span class="p">(</span><span class="s2">&quot;this </span><span class="se">\&quot;</span><span class="s2">is a test</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
 </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs6escapeEPKc6size_t">
<span id="_CPPv3N4pvxs6escapeEPKc6size_t"></span><span id="_CPPv2N4pvxs6escapeEPKc6size_t"></span><span id="pvxs::escape__cCP.s"></span><span class="target" id="namespacepvxs_1adbedff75f35a926981452c876d728e3c"></span>detail::Escaper <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">escape</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>s</em>, size_t <em>n</em><span class="sig-paren">)</span><br /></dt>
<dd><p>Print fixed length char array to output stream with non-printable charactors escaped. <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pvxs</span><span class="p">::</span><span class="n">escape</span><span class="p">(</span><span class="s2">&quot;this </span><span class="se">\&quot;</span><span class="s2">is a test</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
<span class="o">//</span> <span class="n">prints</span> <span class="s1">&#39;this </span><span class="se">\&quot;</span><span class="s1">&#39;</span>
</pre></div>
</div>
 </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv4N4pvxs20cleanup_for_valgrindEv">
<span id="_CPPv3N4pvxs20cleanup_for_valgrindEv"></span><span id="_CPPv2N4pvxs20cleanup_for_valgrindEv"></span><span id="pvxs::cleanup_for_valgrind"></span><span class="target" id="namespacepvxs_1a2eaf125c5e701078a318c9719ce7c7ec"></span>void <code class="descclassname">pvxs<code class="descclassname">::</code></code><code class="descname">cleanup_for_valgrind</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4pvxs20cleanup_for_valgrindEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free some internal global allocations to avoid false positives in valgrind (or similar) tools looking for memory leaks.</p>
<p>Calls libevent_global_shutdown() when available (libevent &gt;=2.1).</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>This function is optional. If you don’t understand the intended use case, then do not call it!</dd>
<dt><strong>Pre</strong></dt>
<dd>Caller must release all resources explicitly allocated through PVXS (on all threads). </dd>
<dt><strong>Post</strong></dt>
<dd>Invalidates internal state. Use of <strong>any</strong> API functions afterwards is undefined! </dd>
</dl>
</p>
</dd></dl>

<dl class="class">
<dt id="_CPPv4N4pvxs6SigIntE">
<span id="_CPPv3N4pvxs6SigIntE"></span><span id="_CPPv2N4pvxs6SigIntE"></span><span id="pvxs::SigInt"></span><span class="target" id="classpvxs_1_1SigInt"></span><em class="property">class </em><code class="descname">SigInt</code><a class="headerlink" href="#_CPPv4N4pvxs6SigIntE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>minimal portable process signal handling in CLI tools.</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">epicsEvent</span> <span class="n">evt</span><span class="p">;</span>
<span class="n">SigInt</span> <span class="n">handle</span><span class="p">([</span><span class="o">&amp;</span><span class="n">evt</span><span class="p">]()</span> <span class="p">{</span>
     <span class="n">evt</span><span class="o">.</span><span class="n">trigger</span><span class="p">();</span>
<span class="p">});</span>
<span class="o">...</span> <span class="n">setup</span> <span class="n">network</span> <span class="n">operations</span>
<span class="n">evt</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>
<span class="o">//</span> <span class="n">completion</span><span class="p">,</span> <span class="ow">or</span> <span class="n">SIGINT</span>
</pre></div>
</div>
 </p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PVXS</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html#including-pvxs-in-your-application">Including PVXS in your application</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="value.html">Value Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Misc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#identification">Identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unit-test-helpers">Unit-test helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="details.html">Reporting a Bug</a></li>
<li class="toctree-l1"><a class="reference internal" href="details.html#contributing">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="details.html#notes">Notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="source.html" title="previous chapter">Data Source API</a></li>
      <li>Next: <a href="example.html" title="next chapter">Examples</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020 Osprey DCS LLC.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/util.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>